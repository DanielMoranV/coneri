<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Migraci√≥n de Datos - CONERI</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #00B98D;
        }
        button {
            background-color: #00B98D;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background-color: #008f6f;
        }
        button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }
        .log {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin-top: 20px;
            max-height: 400px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 12px;
        }
        .success { color: green; }
        .error { color: red; }
        .info { color: blue; }
        .warning { color: orange; }
    </style>

    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-storage.js"></script>
    <script src="js/firebase-config.js"></script>
</head>
<body>
    <div class="container">
        <h1>üîÑ Migraci√≥n de Datos a Firestore</h1>
        <p>Esta herramienta te ayudar√° a migrar los proyectos existentes del sitio web a Firebase Firestore.</p>

        <h3>Proyectos Existentes:</h3>
        <p>Se migrar√°n los siguientes proyectos:</p>
        <ol>
            <li>Sistema de Bombeo Solar Palo Blanco</li>
            <li>Sistema Fotovoltaico Hospital Chulucanas</li>
            <li>Sistema de Bombeo Solar TRIFASICO La Huaca</li>
        </ol>

        <button id="btn-migrar-proyectos" onclick="migrarProyectos()">Migrar Proyectos</button>
        <button id="btn-agregar-ejemplos-productos" onclick="agregarEjemplosProductos()">Agregar Productos de Ejemplo</button>
        <button onclick="limpiarLog()">Limpiar Log</button>

        <div id="log" class="log"></div>
    </div>

    <script>
        function log(mensaje, tipo = 'info') {
            const logDiv = document.getElementById('log');
            const timestamp = new Date().toLocaleTimeString();
            const clase = tipo;
            logDiv.innerHTML += `<div class="${clase}">[${timestamp}] ${mensaje}</div>`;
            logDiv.scrollTop = logDiv.scrollHeight;
        }

        function limpiarLog() {
            document.getElementById('log').innerHTML = '';
        }

        async function migrarProyectos() {
            const btn = document.getElementById('btn-migrar-proyectos');
            btn.disabled = true;

            log('Iniciando migraci√≥n de proyectos...', 'info');

            const proyectos = [
                {
                    titulo: 'Sistema de Bombeo Solar Palo Blanco',
                    descripcion: 'Paneles Solares Directo caudal 180 l/min. Eleva el agua a 100 metros, Bomba Sumergible Pedrollo de 5 HP Trif√°sica. Proyecto de bombeo solar directo para riego agr√≠cola en zona rural.',
                    categoria: 'first',
                    ubicacion: 'Palo Blanco, Chulucanas, Piura',
                    cliente: 'Agricultor Local',
                    activo: true,
                    fecha: firebase.firestore.Timestamp.now(),
                    imagenes: ['img/portfolio-1.webp']
                },
                {
                    titulo: 'Sistema Fotovoltaico Hospital Chulucanas',
                    descripcion: 'Sistema Fotovoltaico ON Grid para Hospital de Chulucanas. Instalaci√≥n de paneles solares para reducci√≥n de costos energ√©ticos y apoyo al sistema de salud local.',
                    categoria: 'second',
                    ubicacion: 'Chulucanas, Piura',
                    cliente: 'Hospital de Chulucanas',
                    activo: true,
                    fecha: firebase.firestore.Timestamp.now(),
                    imagenes: ['img/portfolio-2.webp']
                },
                {
                    titulo: 'Sistema de Bombeo Solar TRIFASICO La Huaca',
                    descripcion: 'Caudal 200 lt/min, el sistema es h√≠brido funciona con energ√≠a solar y con energ√≠a MONOFASICA de la Red, en caso sea necesario su uso en horas de la noche cuando no haya radiaci√≥n solar.',
                    categoria: 'first',
                    ubicacion: 'La Huaca, Paita, Piura',
                    cliente: 'Agricultor Local',
                    activo: true,
                    fecha: firebase.firestore.Timestamp.now(),
                    imagenes: ['img/portfolio-3.webp']
                }
            ];

            try {
                for (let i = 0; i < proyectos.length; i++) {
                    log(`Migrando proyecto ${i + 1}/${proyectos.length}: ${proyectos[i].titulo}...`, 'info');

                    const docRef = await proyectosRef.add(proyectos[i]);
                    log(`‚úì Proyecto migrado exitosamente (ID: ${docRef.id})`, 'success');
                }

                log('==========================================', 'info');
                log('‚úì Migraci√≥n completada exitosamente!', 'success');
                log(`Total de proyectos migrados: ${proyectos.length}`, 'success');
                log('==========================================', 'info');

            } catch (error) {
                log(`‚úó Error durante la migraci√≥n: ${error.message}`, 'error');
                console.error(error);
            } finally {
                btn.disabled = false;
            }
        }

        async function agregarEjemplosProductos() {
            const btn = document.getElementById('btn-agregar-ejemplos-productos');
            btn.disabled = true;

            log('Agregando productos de ejemplo...', 'info');

            const productos = [
                {
                    nombre: 'Panel Solar Monocristalino 450W',
                    descripcion: 'Panel solar de alta eficiencia con c√©lulas monocristalinas de √∫ltima generaci√≥n. Ideal para instalaciones residenciales y comerciales. Garant√≠a de 25 a√±os en rendimiento.',
                    categoria: 'paneles',
                    precio: 450.00,
                    orden: 1,
                    activo: true,
                    imagenes: ['https://via.placeholder.com/400x300/00B98D/FFFFFF?text=Panel+Solar+450W'],
                    especificaciones: {
                        'Potencia': '450W',
                        'Voltaje': '24V',
                        'Eficiencia': '21.5%',
                        'Dimensiones': '1960 x 990 x 40 mm',
                        'Peso': '23.5 kg',
                        'Garant√≠a': '25 a√±os'
                    }
                },
                {
                    nombre: 'Inversor H√≠brido 5kW',
                    descripcion: 'Inversor h√≠brido de √∫ltima generaci√≥n con control inteligente de energ√≠a. Compatible con bater√≠as y conexi√≥n a red. Monitoreo remoto v√≠a WiFi.',
                    categoria: 'inversores',
                    precio: 1850.00,
                    orden: 2,
                    activo: true,
                    imagenes: ['https://via.placeholder.com/400x300/0056b3/FFFFFF?text=Inversor+5kW'],
                    especificaciones: {
                        'Potencia': '5000W',
                        'Voltaje de entrada': '48V DC',
                        'Voltaje de salida': '220V AC',
                        'Eficiencia': '97.5%',
                        'Conexi√≥n': 'Grid-Tied + Off-Grid',
                        'Garant√≠a': '5 a√±os'
                    }
                },
                {
                    nombre: 'Bater√≠a de Litio 5.12kWh',
                    descripcion: 'Bater√≠a de litio de alta capacidad para sistemas de almacenamiento de energ√≠a solar. Larga vida √∫til y m√≠nimo mantenimiento. Expandible hasta 20kWh.',
                    categoria: 'baterias',
                    precio: 2200.00,
                    orden: 3,
                    activo: true,
                    imagenes: ['https://via.placeholder.com/400x300/764ba2/FFFFFF?text=Bateria+5.12kWh'],
                    especificaciones: {
                        'Capacidad': '5.12 kWh',
                        'Voltaje': '51.2V',
                        'Tecnolog√≠a': 'LiFePO4',
                        'Ciclos de vida': '>6000 ciclos',
                        'Peso': '45 kg',
                        'Garant√≠a': '10 a√±os'
                    }
                },
                {
                    nombre: 'Bomba Solar Sumergible 1HP',
                    descripcion: 'Bomba sumergible de alta eficiencia para sistemas de bombeo solar. Ideal para pozos profundos. Opera directamente con paneles solares sin necesidad de bater√≠as.',
                    categoria: 'bombas',
                    precio: 850.00,
                    orden: 4,
                    activo: true,
                    imagenes: ['https://via.placeholder.com/400x300/667eea/FFFFFF?text=Bomba+Solar+1HP'],
                    especificaciones: {
                        'Potencia': '1 HP (750W)',
                        'Caudal m√°ximo': '120 L/min',
                        'Altura m√°xima': '80 metros',
                        'Voltaje': '48V DC',
                        'Material': 'Acero inoxidable',
                        'Garant√≠a': '2 a√±os'
                    }
                },
                {
                    nombre: 'Estructura para Techo 10 Paneles',
                    descripcion: 'Estructura de aluminio de alta resistencia para montaje de paneles solares en techo. Incluye todos los accesorios de instalaci√≥n. Soporta vientos de hasta 180 km/h.',
                    categoria: 'estructuras',
                    precio: 350.00,
                    orden: 5,
                    activo: true,
                    imagenes: ['https://via.placeholder.com/400x300/00B98D/FFFFFF?text=Estructura+Aluminio'],
                    especificaciones: {
                        'Capacidad': '10 paneles',
                        'Material': 'Aluminio anodizado',
                        'Inclinaci√≥n': '15¬∞ - 30¬∞ ajustable',
                        'Resistencia al viento': '180 km/h',
                        'Peso': '35 kg',
                        'Garant√≠a': '10 a√±os'
                    }
                },
                {
                    nombre: 'Cable Solar 6mm¬≤ Doble Aislamiento',
                    descripcion: 'Cable especial para instalaciones fotovoltaicas con doble aislamiento resistente a UV. Certificado TUV. Rollo de 100 metros.',
                    categoria: 'cables',
                    precio: 180.00,
                    orden: 6,
                    activo: true,
                    imagenes: ['https://via.placeholder.com/400x300/dc3545/FFFFFF?text=Cable+Solar+6mm'],
                    especificaciones: {
                        'Secci√≥n': '6 mm¬≤',
                        'Voltaje m√°ximo': '1.8 kV DC',
                        'Corriente m√°xima': '70A',
                        'Temperatura': '-40¬∞C a +90¬∞C',
                        'Longitud': '100 metros',
                        'Certificaci√≥n': 'TUV'
                    }
                }
            ];

            try {
                for (let i = 0; i < productos.length; i++) {
                    log(`Agregando producto ${i + 1}/${productos.length}: ${productos[i].nombre}...`, 'info');

                    const docRef = await productosRef.add(productos[i]);
                    log(`‚úì Producto agregado exitosamente (ID: ${docRef.id})`, 'success');
                }

                log('==========================================', 'info');
                log('‚úì Productos de ejemplo agregados exitosamente!', 'success');
                log(`Total de productos agregados: ${productos.length}`, 'success');
                log('==========================================', 'info');
                log('‚ö† Recuerda reemplazar las im√°genes placeholder con im√°genes reales.', 'warning');

            } catch (error) {
                log(`‚úó Error al agregar productos: ${error.message}`, 'error');
                console.error(error);
            } finally {
                btn.disabled = false;
            }
        }

        log('Sistema de migraci√≥n listo. Haz clic en los botones para iniciar.', 'info');
    </script>
</body>
</html>
