<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Detalle del Proyecto - CONERI | Energías Renovables</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="proyecto solar, instalación fotovoltaica, energías renovables, coneri" name="keywords">
    <meta content="Detalle completo del proyecto de energía solar realizado por CONERI" name="description">

    <!-- Favicon -->
    <link href="img/iconos/logoConeri.png" rel="icon">

    <!-- Google Web Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;500&family=Roboto:wght@500;700;900&display=swap" rel="stylesheet">

    <!-- Icon Font Stylesheet -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <!-- Libraries Stylesheet -->
    <link href="lib/animate/animate.min.css" rel="stylesheet">
    <link href="lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet">
    <link href="lib/lightbox/css/lightbox.min.css" rel="stylesheet">

    <!-- Customized Bootstrap Stylesheet -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Template Stylesheet -->
    <link href="css/style.css" rel="stylesheet">

    <style>
        .proyecto-header {
            background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url('img/carousel-3.jpg');
            background-size: cover;
            background-position: center;
            padding: 100px 0;
        }

        .proyecto-galeria img {
            cursor: pointer;
            transition: transform 0.3s;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .proyecto-galeria img:hover {
            transform: scale(1.05);
        }

        .proyecto-info-card {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }

        .info-item {
            padding: 15px 0;
            border-bottom: 1px solid #f0f0f0;
        }

        .info-item:last-child {
            border-bottom: none;
        }

        .info-label {
            font-weight: 600;
            color: #00B98D;
            margin-right: 10px;
        }

        .galeria-principal {
            position: relative;
            height: 500px;
            overflow: hidden;
            border-radius: 15px;
            margin-bottom: 30px;
        }

        .galeria-principal img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .galeria-thumbnails {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
        }

        .thumbnail {
            height: 150px;
            overflow: hidden;
            border-radius: 8px;
            cursor: pointer;
            border: 3px solid transparent;
            transition: all 0.3s;
        }

        .thumbnail:hover,
        .thumbnail.active {
            border-color: #00B98D;
        }

        .thumbnail img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
    </style>

    <!-- Firebase (sin defer para garantizar orden) -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

    <!-- Firebase Config -->
    <script src="js/firebase-config.js"></script>
</head>

<body>
    <!-- Spinner Start -->
    <div id="spinner" class="show bg-white position-fixed translate-middle w-100 vh-100 top-50 start-50 d-flex align-items-center justify-content-center">
        <div class="spinner-border text-primary" style="width: 3rem; height: 3rem;" role="status">
            <span class="sr-only">Loading...</span>
        </div>
    </div>
    <!-- Spinner End -->

    <!-- Topbar Start -->
    <div class="container-fluid bg-dark px-5">
        <div class="row gx-4 d-none d-lg-flex">
            <div class="col-lg-6 text-start">
                <div class="h-100 d-inline-flex align-items-center py-3 me-4">
                    <div class="btn-sm-square rounded-circle bg-primary me-2">
                        <small class="far fa-building text-white"></small>
                    </div>
                    <small>RUC: 20601297541</small>
                </div>
                <div class="h-100 d-inline-flex align-items-center py-3">
                    <div class="btn-sm-square rounded-circle bg-primary me-2">
                        <small class="fa fa-envelope-open text-white"></small>
                    </div>
                    <small>coneri.eirl@gmail.com</small>
                </div>
            </div>
            <div class="col-lg-6 text-end">
                <div class="h-100 d-inline-flex align-items-center py-3 me-4">
                    <div class="btn-sm-square rounded-circle bg-primary me-2">
                        <small class="fa fa-phone-alt text-white"></small>
                    </div>
                    <small>+51 941830829</small>
                </div>
                <div class="h-100 d-inline-flex align-items-center py-3">
                    <div class="btn-sm-square rounded-circle bg-primary me-2">
                        <small class="far fa-clock text-white"></small>
                    </div>
                    <small>Lun - Sab : 9AM - 9PM</small>
                </div>
            </div>
        </div>
    </div>
    <!-- Topbar End -->

    <!-- Navbar Start -->
    <nav class="navbar navbar-expand-lg bg-white navbar-light sticky-top p-0 px-4 px-lg-5">
        <a href="index.html" class="navbar-brand d-flex align-items-center">
            <img src="img/iconos/logoConeri.png" class="logo">
            <h2 class="m-0 text-primary">CONERI</h2>
        </a>
        <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbarCollapse">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarCollapse">
            <div class="navbar-nav ms-auto py-4 py-lg-0">
                <a href="index.html" class="nav-item nav-link">Inicio</a>
                <a href="about.html" class="nav-item nav-link">Nosotros</a>
                <a href="service.html" class="nav-item nav-link">Servicios</a>
                <a href="project.html" class="nav-item nav-link active">Casos de Éxito</a>
                <a href="catalogo.html" class="nav-item nav-link">Catálogo</a>
                <a href="contact.html" class="nav-item nav-link">Contacto</a>
            </div>
            <div class="h-100 d-lg-inline-flex align-items-center d-none">
                <a class="btn btn-square rounded-circle bg-light text-primary me-2" href="https://www.facebook.com/Coneripiura" target="_blank"><i class="fab fa-facebook-f"></i></a>
                <a class="btn btn-square rounded-circle bg-light text-primary me-2" href="https://api.whatsapp.com/send?phone=51941830829&text=Hola%20requiero%20informaci%C3%B3n%20de%20sus%20servicios%20en%20sistemas%20fotovoltaicos" target="_blank"><i class="fab fa-whatsapp"></i></a>
                <a class="btn btn-square rounded-circle bg-light text-primary me-2" href="https://www.linkedin.com/in/jilmer-leonel-parrilla-calle-2960b834/" target="_blank"><i class="fab fa-linkedin-in"></i></a>
                <a class="btn btn-square rounded-circle bg-light text-primary me-0" href="https://www.tiktok.com/@jilmer941830829" target="_blank"><i class="fab fa-tiktok"></i></a>
            </div>
        </div>
    </nav>
    <!-- Navbar End -->

    <!-- Page Header Start -->
    <div class="container-fluid page-header py-5 mb-5">
        <div class="container py-5">
            <h1 class="display-3 text-white mb-3 animated slideInDown" id="proyecto-titulo">Cargando...</h1>
            <nav aria-label="breadcrumb animated slideInDown">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a class="text-white" href="index.html">Inicio</a></li>
                    <li class="breadcrumb-item"><a class="text-white" href="project.html">Proyectos</a></li>
                    <li class="breadcrumb-item text-white active" aria-current="page">Detalle</li>
                </ol>
            </nav>
        </div>
    </div>
    <!-- Page Header End -->

    <!-- Project Detail Start -->
    <div class="container-xxl py-5">
        <div class="container">
            <div class="row g-5">
                <!-- Galería -->
                <div class="col-lg-8">
                    <div id="galeria-container">
                        <!-- La galería se cargará dinámicamente -->
                        <div class="text-center">
                            <div class="spinner-border text-primary" role="status"></div>
                        </div>
                    </div>

                    <!-- Descripción -->
                    <div class="proyecto-info-card mt-4">
                        <h3 class="mb-4"><i class="fa fa-info-circle me-2 text-primary"></i>Descripción del Proyecto</h3>
                        <p id="proyecto-descripcion" class="text-muted">Cargando descripción...</p>
                    </div>
                </div>

                <!-- Información del Proyecto -->
                <div class="col-lg-4">
                    <div class="proyecto-info-card">
                        <h4 class="mb-4"><i class="fa fa-clipboard-list me-2 text-primary"></i>Información del Proyecto</h4>

                        <div id="proyecto-info">
                            <!-- La información se cargará dinámicamente -->
                            <div class="text-center">
                                <div class="spinner-border text-primary spinner-border-sm" role="status"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Botones de Acción -->
                    <div class="d-grid gap-2 mt-4">
                        <a href="contact.html" class="btn btn-primary btn-lg">
                            <i class="fa fa-envelope me-2"></i>Solicitar Información
                        </a>
                        <a href="project.html" class="btn btn-outline-primary btn-lg">
                            <i class="fa fa-arrow-left me-2"></i>Ver Más Proyectos
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Project Detail End -->

    <!-- Footer Start -->
    <div class="container-fluid bg-dark text-secondary footer mt-5 py-5">
        <div class="container py-5">
            <div class="row g-5">
                <div class="col-lg-3 col-md-6">
                    <h5 class="text-light mb-4">Dirección</h5>
                    <p class="mb-2"><i class="fa fa-map-marker-alt me-3"></i>Piura | Lima</p>
                    <p class="mb-2"><i class="fa fa-phone-alt me-3"></i>+51 941830829</p>
                    <p class="mb-2"><i class="fa fa-envelope me-3"></i>coneri.eirl@gmail.com</p>
                    <div class="d-flex pt-2">
                        <a class="btn btn-square btn-outline-secondary rounded-circle me-2" href="https://www.facebook.com/Coneripiura" target="_blank"><i class="fab fa-facebook-f"></i></a>
                        <a class="btn btn-square btn-outline-secondary rounded-circle me-2" href="https://api.whatsapp.com/send?phone=51941830829&text=Hola%20requiero%20informaci%C3%B3n%20de%20sus%20servicios%20en%20sistemas%20fotovoltaicos" target="_blank"><i class="fab fa-whatsapp"></i></a>
                        <a class="btn btn-square btn-outline-secondary rounded-circle me-2" href="https://www.linkedin.com/in/jilmer-leonel-parrilla-calle-2960b834/" target="_blank"><i class="fab fa-linkedin-in"></i></a>
                        <a class="btn btn-square btn-outline-secondary rounded-circle me-2" href="https://www.tiktok.com/@jilmer941830829" target="_blank"><i class="fab fa-tiktok"></i></a>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6">
                    <h5 class="text-light mb-4">Servicios</h5>
                    <a class="btn btn-link" href="service.html">Dimensionamiento</a>
                    <a class="btn btn-link" href="service.html">Suministro</a>
                    <a class="btn btn-link" href="service.html">Instalación</a>
                    <a class="btn btn-link" href="service.html">Mantenimiento</a>
                </div>
                <div class="col-lg-3 col-md-6">
                    <h5 class="text-light mb-4">Enlaces Rápidos</h5>
                    <a class="btn btn-link" href="about.html">Nosotros</a>
                    <a class="btn btn-link" href="contact.html">Contacto</a>
                    <a class="btn btn-link" href="service.html">Servicios</a>
                    <a class="btn btn-link" href="project.html">Proyectos</a>
                </div>
                <div class="col-lg-3 col-md-6">
                    <p>"El sol es una fuente inagotable de energía, y al utilizar paneles solares estás aprovechando su poder para impulsar un futuro más limpio y sostenible."</p>
                </div>
            </div>
        </div>
    </div>
    <!-- Footer End -->

    <!-- Copyright Start -->
    <div class="container-fluid py-4" style="background: #000000;">
        <div class="container">
            <div class="row">
                <div class="col-md-6 text-center text-md-start mb-3 mb-md-0">
                    &copy; <a class="border-bottom" href="https://coneri.pe/">coneri.pe</a>, Todos los derechos reservados.
                </div>
                <div class="col-md-6 text-center text-md-end">
                    <p class="by">Made with ♥ by. <a href="https://www.linkedin.com/in/danielmoranv/" target="_blank">Daniel Moran</a></p>
                </div>
            </div>
        </div>
    </div>
    <!-- Copyright End -->

    <!-- Back to Top -->
    <a href="#" class="btn btn-lg btn-primary btn-lg-square rounded-circle back-to-top"><i class="bi bi-arrow-up"></i></a>

    <!-- JavaScript Libraries -->
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="lib/wow/wow.min.js"></script>
    <script src="lib/easing/easing.min.js"></script>
    <script src="lib/waypoints/waypoints.min.js"></script>
    <script src="lib/counterup/counterup.min.js"></script>
    <script src="lib/owlcarousel/owl.carousel.min.js"></script>
    <script src="lib/lightbox/js/lightbox.min.js"></script>

    <!-- Template Javascript -->
    <script src="js/main.js"></script>

    <script>
        let proyectoActual = null;

        document.addEventListener('DOMContentLoaded', async function() {
            // Obtener ID del proyecto desde URL
            const urlParams = new URLSearchParams(window.location.search);
            const proyectoId = urlParams.get('id');

            if (!proyectoId) {
                mostrarError('No se especificó un proyecto');
                return;
            }

            await cargarProyecto(proyectoId);

            // Ocultar spinner
            document.getElementById('spinner').classList.remove('show');
        });

        /**
         * Cargar información del proyecto
         */
        async function cargarProyecto(id) {
            try {
                const doc = await proyectosRef.doc(id).get();

                if (!doc.exists) {
                    mostrarError('Proyecto no encontrado');
                    return;
                }

                proyectoActual = { id: doc.id, ...doc.data() };
                renderizarProyecto(proyectoActual);

            } catch (error) {
                console.error('Error al cargar proyecto:', error);
                mostrarError('Error al cargar el proyecto. Por favor, intente más tarde.');
            }
        }

        /**
         * Renderizar información del proyecto
         */
        function renderizarProyecto(proyecto) {
            // Título
            document.getElementById('proyecto-titulo').textContent = proyecto.titulo || 'Proyecto Sin Título';

            // Descripción
            document.getElementById('proyecto-descripcion').textContent = proyecto.descripcion || 'Sin descripción disponible.';

            // Galería
            renderizarGaleria(proyecto.imagenes || []);

            // Información del proyecto
            renderizarInformacion(proyecto);
        }

        /**
         * Renderizar galería de imágenes
         */
        function renderizarGaleria(imagenes) {
            const container = document.getElementById('galeria-container');

            if (!imagenes || imagenes.length === 0) {
                container.innerHTML = `
                    <div class="alert alert-info">
                        <i class="fa fa-info-circle me-2"></i>No hay imágenes disponibles para este proyecto.
                    </div>
                `;
                return;
            }

            let galeriaHTML = `
                <div class="galeria-principal">
                    <a href="${imagenes[0]}" data-lightbox="proyecto" data-title="${proyectoActual.titulo}">
                        <img src="${imagenes[0]}" alt="${proyectoActual.titulo}" id="imagen-principal">
                    </a>
                </div>
            `;

            if (imagenes.length > 1) {
                galeriaHTML += '<div class="galeria-thumbnails">';
                imagenes.forEach((img, index) => {
                    galeriaHTML += `
                        <div class="thumbnail ${index === 0 ? 'active' : ''}" onclick="cambiarImagenPrincipal('${img}', ${index})">
                            <img src="${img}" alt="Thumbnail ${index + 1}">
                        </div>
                    `;

                    // Agregar al lightbox
                    if (index > 0) {
                        galeriaHTML += `<a href="${img}" data-lightbox="proyecto" data-title="${proyectoActual.titulo}" style="display:none;"></a>`;
                    }
                });
                galeriaHTML += '</div>';
            }

            container.innerHTML = galeriaHTML;
        }

        /**
         * Cambiar imagen principal
         */
        function cambiarImagenPrincipal(urlImagen, index) {
            document.getElementById('imagen-principal').src = urlImagen;

            // Actualizar thumbnails activos
            document.querySelectorAll('.thumbnail').forEach((thumb, i) => {
                if (i === index) {
                    thumb.classList.add('active');
                } else {
                    thumb.classList.remove('active');
                }
            });
        }

        /**
         * Renderizar información del proyecto
         */
        function renderizarInformacion(proyecto) {
            const container = document.getElementById('proyecto-info');
            const categoria = proyecto.categoria === 'first' ? 'Proyecto Culminado' : 'Proyecto en Marcha';

            let infoHTML = '';

            if (proyecto.categoria) {
                infoHTML += `
                    <div class="info-item">
                        <span class="info-label"><i class="fa fa-tag me-2"></i>Estado:</span>
                        <span class="badge bg-${proyecto.categoria === 'first' ? 'success' : 'warning'}">${categoria}</span>
                    </div>
                `;
            }

            if (proyecto.ubicacion) {
                infoHTML += `
                    <div class="info-item">
                        <span class="info-label"><i class="fa fa-map-marker-alt me-2"></i>Ubicación:</span>
                        <span>${proyecto.ubicacion}</span>
                    </div>
                `;
            }

            if (proyecto.cliente) {
                infoHTML += `
                    <div class="info-item">
                        <span class="info-label"><i class="fa fa-user me-2"></i>Cliente:</span>
                        <span>${proyecto.cliente}</span>
                    </div>
                `;
            }

            if (proyecto.fecha) {
                const fecha = new Date(proyecto.fecha.toDate()).toLocaleDateString('es-PE', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });
                infoHTML += `
                    <div class="info-item">
                        <span class="info-label"><i class="fa fa-calendar me-2"></i>Fecha:</span>
                        <span>${fecha}</span>
                    </div>
                `;
            }

            container.innerHTML = infoHTML || '<p class="text-muted">No hay información adicional disponible.</p>';
        }

        /**
         * Mostrar error
         */
        function mostrarError(mensaje) {
            document.getElementById('proyecto-titulo').textContent = 'Error';
            document.getElementById('proyecto-descripcion').textContent = mensaje;
            document.getElementById('galeria-container').innerHTML = `
                <div class="alert alert-danger">
                    <i class="fa fa-exclamation-triangle me-2"></i>${mensaje}
                </div>
            `;
            document.getElementById('proyecto-info').innerHTML = `
                <a href="project.html" class="btn btn-primary w-100">
                    <i class="fa fa-arrow-left me-2"></i>Volver a Proyectos
                </a>
            `;
        }
    </script>
</body>

</html>
